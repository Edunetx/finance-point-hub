<!-- CHUNK 1-4: Admin Panel Base, Header, Tabs, and Downloads Section --><!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Panel | FINSA</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage-compat.js"></script>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: linear-gradient(to bottom right, #c7d2fe, #fbcfe8);
      color: #1e293b;
    }
    header {
      background: linear-gradient(to right, #ec4899, #6366f1);
      color: white;
      padding: 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .logout-btn {
      background-color: #ef4444;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
    }
    .tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      padding: 1rem;
      justify-content: center;
    }
    .tabs button {
      padding: 0.7rem 1.2rem;
      background: #f472b6;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      color: white;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .tabs button.active {
      background: #7c3aed;
    }
    section {
      display: none;
      margin: 1rem auto;
      padding: 1.5rem;
      width: 95%;
      max-width: 900px;
      border-radius: 16px;
      background: linear-gradient(to right bottom, #fce7f3, #e0e7ff);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    section.active {
      display: block;
    }
    .card {
      background: linear-gradient(to bottom, #f9a8d4, #d8b4fe);
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
      color: #111827;
    }
    input, textarea {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: none;
      margin-top: 8px;
      font-size: 1rem;
    }
    .material-item {
      background: white;
      padding: 0.75rem;
      margin-bottom: 0.5rem;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .material-item span { flex: 1; }
    .material-item button {
      background: #ef4444;
      border: none;
      padding: 0.3rem 0.6rem;
      color: white;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header>
    <h2>FINSA Admin Panel</h2>
    <button class="logout-btn" onclick="logoutUser()">Logout</button>
  </header>  <div class="tabs">
    <button class="tab-link active" data-tab="downloads">Downloads</button>
    <button class="tab-link" data-tab="settings">Settings</button>
    <!-- Add other tabs here -->
  </div>  <section id="downloads" class="active">
    <h3>Materials Upload</h3>
    <div class="card">
      <input type="text" id="materialTitle" placeholder="Material Title">
      <textarea id="materialDesc" placeholder="Short description (optional)"></textarea>
      <input type="text" id="materialLink" placeholder="Download Link (e.g., Google Drive)">
      <br><br>
      <button onclick="uploadMaterial()">Upload Material</button>
    </div>
    <div class="card">
      <h4>Uploaded Materials</h4>
      <div id="materialsList"></div>
    </div>
  </section>
  <section id="home">
    <h3>Home Manager</h3>

    <div class="card">
      <h4>Add Finance Tip</h4>
      <textarea id="tipInput" rows="2" placeholder="Enter a new tip..."></textarea>
      <button onclick="addFinanceTip()">Add Tip</button>
      <ul id="tipList"></ul>
    </div>

    <div class="card">
      <h4>Add Birthday</h4>
      <input type="text" id="bdayName" placeholder="Name">
      <input type="date" id="bdayDate">
      <input type="file" id="bdayImage" accept="image/*" />
      <button onclick="addBirthday()">Add Birthday</button>
      <ul id="birthdayList"></ul>
    </div>

    <div class="card">
      <h4>Upload Ad Banner</h4>
      <input type="file" id="adImage" accept="image/*" />
      <input type="text" id="adLink" placeholder="Ad redirect link (optional)">
      <img id="adPreview" src="" style="max-height: 150px; display: none;" />
      <button onclick="uploadAd()">Upload Ad</button>
    </div>
  </section>

  <section id="announcements">
    <h3>Announcements</h3>
    <div class="card">
      <textarea id="announceInput" rows="2" placeholder="Type announcement..."></textarea>
      <button onclick="postAnnouncement()">Post Announcement</button>
    </div>
    <div class="card">
      <ul id="announcementList"></ul>
    </div>
  </section>

  <section id="events">
    <h3>Events</h3>
    <div class="card">
      <input type="text" id="eventTitle" placeholder="Event Title">
      <textarea id="eventDescription" placeholder="Event Description"></textarea>
      <input type="date" id="eventDate">
      <button onclick="addEvent()">Add Event</button>
    </div>
    <div class="card">
      <ul id="eventList"></ul>
    </div>
  </section>

  <section id="cbt">
    <h3>CBT Manager</h3>
    <div class="card">
      <input type="text" id="cbtSubject" placeholder="Subject">
      <textarea id="cbtQuestion" placeholder="Question"></textarea>
      <input type="text" id="optionA" placeholder="Option A">
      <input type="text" id="optionB" placeholder="Option B">
      <input type="text" id="optionC" placeholder="Option C">
      <input type="text" id="optionD" placeholder="Option D">
      <input type="text" id="correctAnswer" placeholder="Correct Option (A-D)">
      <button onclick="addCBTQuestion()">Upload Question</button>
    </div>
    <div class="card">
      <ul id="cbtList"></ul>
    </div>
  </section>

  <section id="lostfound">
    <h3>Lost & Found</h3>
    <div class="card">
      <ul id="lostFoundList"></ul>
    </div>
  </section>
  <section id="feedback">
    <h3>Feedback</h3>
    <div class="card">
      <ul id="feedbackList"></ul>
    </div>
  </section>

  <section id="settings">
    <h3>Settings</h3>
    <div class="card">
      <p>You can manage upcoming features here.</p>
      <label>
        <input type="checkbox" id="maintenanceToggle" /> Enable Maintenance Mode
      </label>
      <br><br>
      <button onclick="saveSettings()">Save Settings</button>
    </div>
  </section>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCH5H1FWEcHmQiCQhoc6GE8GhizqhTZoQc",
      authDomain: "finsa-connect.firebaseapp.com",
      projectId: "finsa-connect",
      storageBucket: "finsa-connect.appspot.com",
      messagingSenderId: "126845965255",
      appId: "1:126845965255:web:c82539297a8464873d7fe2"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const announcementsRef = db.collection("announcements");
    const eventsRef = db.collection("events");
    const cbtRef = db.collection("cbt");
    const lostFoundRef = db.collection("lostfound");
    const financeTipsRef = db.collection("financeTips");
    const feedbackRef = db.collection("feedbacks");

    // Tab switch logic
    document.querySelectorAll('.tab-link').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-link').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const tab = btn.getAttribute('data-tab');
        document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
        document.getElementById(tab).classList.add('active');
      });
    });

    function logoutUser() {
      firebase.auth().signOut().then(() => {
        window.location.href = "login.html";
      });
    }

    // ------------------ Home Section --------------------
    async function addFinanceTip() {
      const tip = document.getElementById("tipInput").value.trim();
      if (!tip) return alert("Enter a tip");
      await financeTipsRef.add({ tip, timestamp: Date.now() });
      alert("Tip added");
      document.getElementById("tipInput").value = "";
    }

    async function addBirthday() {
      const name = document.getElementById("bdayName").value.trim();
      const date = document.getElementById("bdayDate").value;
      const image = document.getElementById("bdayImage").files[0];

      const response = await fetch("https://api.jsonstorage.net/v1/json/d33236c3-a3da-4c87-8d18-eeeb899d034a/f8f949fe-792a-45c4-b45a-97592828f554");
      const data = await response.json();
      data.push({ name, date, image: image ? URL.createObjectURL(image) : "" });

      await fetch("https://api.jsonstorage.net/v1/json/d33236c3-a3da-4c87-8d18-eeeb899d034a/f8f949fe-792a-45c4-b45a-97592828f554", {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      alert("Birthday added");
    }

    async function uploadAd() {
      const file = document.getElementById("adImage").files[0];
      const link = document.getElementById("adLink").value;

      const response = await fetch("https://api.jsonstorage.net/v1/json/d33236c3-a3da-4c87-8d18-eeeb899d034a/332cf24c-c9ba-4df8-b062-f3edf244c1fc");
      const data = await response.json();
      data.push({ image: URL.createObjectURL(file), link });

      await fetch("https://api.jsonstorage.net/v1/json/d33236c3-a3da-4c87-8d18-eeeb899d034a/332cf24c-c9ba-4df8-b062-f3edf244c1fc", {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      alert("Ad uploaded");
    }

    // ---------------- Announcements ----------------
    async function postAnnouncement() {
      const text = document.getElementById("announceInput").value.trim();
      if (!text) return alert("Enter something");
      await announcementsRef.add({ text, timestamp: Date.now() });
      document.getElementById("announceInput").value = "";
      loadAnnouncements();
    }

    async function loadAnnouncements() {
      const list = document.getElementById("announcementList");
      list.innerHTML = "";
      const snapshot = await announcementsRef.orderBy("timestamp", "desc").get();
      snapshot.forEach(doc => {
        const li = document.createElement("li");
        li.textContent = doc.data().text;
        const delBtn = document.createElement("button");
        delBtn.textContent = "Delete";
        delBtn.onclick = async () => {
          await announcementsRef.doc(doc.id).delete();
          loadAnnouncements();
        };
        li.appendChild(delBtn);
        list.appendChild(li);
      });
    }

    // ---------------- Events ----------------
    async function addEvent() {
      const title = document.getElementById("eventTitle").value;
      const desc = document.getElementById("eventDescription").value;
      const date = document.getElementById("eventDate").value;
      if (!title || !desc || !date) return alert("Fill all fields");
      await eventsRef.add({ title, desc, date });
      alert("Event Added");
      loadEvents();
    }

    async function loadEvents() {
      const list = document.getElementById("eventList");
      list.innerHTML = "";
      const snapshot = await eventsRef.get();
      snapshot.forEach(doc => {
        const li = document.createElement("li");
        li.textContent = `${doc.data().title} - ${doc.data().date}`;
        const del = document.createElement("button");
        del.textContent = "Delete";
        del.onclick = async () => {
          await eventsRef.doc(doc.id).delete();
          loadEvents();
        };
        li.appendChild(del);
        list.appendChild(li);
      });
    }

    // ---------------- CBT ----------------
    async function addCBTQuestion() {
      const data = {
        subject: document.getElementById("cbtSubject").value,
        question: document.getElementById("cbtQuestion").value,
        options: {
          A: document.getElementById("optionA").value,
          B: document.getElementById("optionB").value,
          C: document.getElementById("optionC").value,
          D: document.getElementById("optionD").value
        },
        correct: document.getElementById("correctAnswer").value.toUpperCase()
      };
      await cbtRef.add(data);
      alert("CBT Question Added");
    }

    // ---------------- Feedback ----------------
    async function loadFeedback() {
      const list = document.getElementById("feedbackList");
      list.innerHTML = "";
      const snapshot = await feedbackRef.get();
      snapshot.forEach(doc => {
        const li = document.createElement("li");
        li.textContent = doc.data().message || "No message";
        const del = document.createElement("button");
        del.textContent = "Delete";
        del.onclick = async () => {
          await feedbackRef.doc(doc.id).delete();
          loadFeedback();
        };
        li.appendChild(del);
        list.appendChild(li);
      });
    }

    // ---------------- Materials (Downloads via JSON) ----------------
    async function uploadMaterial() {
      const title = document.getElementById("materialTitle").value;
      const desc = document.getElementById("materialDesc").value;
      const link = document.getElementById("materialLink").value;

      const response = await fetch("https://api.jsonstorage.net/v1/json/d33236c3-a3da-4c87-8d18-eeeb899d034a/325bec14-accd-4dc4-89d5-87a84da74c36");
      const data = await response.json();
      data.push({ title, desc, link });

      await fetch("https://api.jsonstorage.net/v1/json/d33236c3-a3da-4c87-8d18-eeeb899d034a/325bec14-accd-4dc4-89d5-87a84da74c36", {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      alert("Material uploaded");
    }

    // ---------------- Settings ----------------
    function saveSettings() {
      const maintenance = document.getElementById("maintenanceToggle").checked;
      alert("Saved (future use): Maintenance mode = " + maintenance);
    }

    // ---------------- Loaders ----------------
    firebase.auth().onAuthStateChanged(user => {
      if (!user) location.href = "login.html";
      else {
        loadAnnouncements();
        loadEvents();
        loadFeedback();
      }
    });
  </script>
</body>
</html>
