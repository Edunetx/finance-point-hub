<!-- âœ… CHUNK 1: START OF admin.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Panel | Finance Point</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage-compat.js"></script>

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f9fbfd;
      margin: 0;
      padding: 0;
      color: #1e293b;
    }
    header {
      background-color: #0f172a;
      color: white;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .tabs {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      background-color: #e2e8f0;
      padding: 0.75rem 1rem;
    }
    .tabs button {
      background: none;
      border: none;
      font-weight: 600;
      cursor: pointer;
      padding: 8px 14px;
      border-radius: 8px;
      color: #1e293b;
    }
    .tabs button.active {
      background-color: #0f172a;
      color: white;
    }
    section {
      display: none;
      padding: 1.5rem;
    }
    section.active {
      display: block;
      background: white;
      margin: 1rem;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }
    .logout-btn {
      background-color: crimson;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
    }
    button, input, textarea, select {
      font-family: inherit;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #cbd5e1;
      padding: 8px;
      margin-top: 6px;
    }
    button {
      background-color: #0f172a;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #1e293b;
    }
    input[type="file"] {
      border: none;
    }
    img {
      max-width: 100%;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <!-- âœ… CHUNK 2: BODY START + HEADER + TABS + AUTH LOCK -->

  <header>
    <h2>Finance Point Admin Panel</h2>
    <button class="logout-btn" onclick="logoutUser()">Logout</button>
  </header>

  <!-- âœ… Tabs Navigation -->
  <div class="tabs">
    <button class="tab-link active" data-tab="home">ğŸ  Home</button>
    <button class="tab-link" data-tab="announcements">ğŸ“¢ Announcements</button>
    <button class="tab-link" data-tab="events">ğŸ“… Events</button>
    <button class="tab-link" data-tab="cbt">ğŸ§  CBT</button>
    <button class="tab-link" data-tab="lostfound">ğŸ’ Lost & Found</button>
    <button class="tab-link" data-tab="leaderboard">ğŸ† Leaderboard</button>
    <button class="tab-link" data-tab="feedback">ğŸ’Œ Feedback</button>
    <button class="tab-link" data-tab="downloads">ğŸ“‚ Downloads</button>
    <button class="tab-link" data-tab="settings">âš™ï¸ Settings</button>
  </div>

  <!-- âœ… Firebase Init -->
  <script>
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_MSG_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    const storage = firebase.storage();

    auth.onAuthStateChanged(user => {
      if (!user || user.email !== 'ayubaboluwatife246@gmail.com') {
        alert('Access denied. Admin only.');
        window.location.href = '/login.html';
      }
    });

    function logoutUser() {
      auth.signOut().then(() => {
        window.location.href = '/login.html';
      });
    }
  </script>

  <!-- âœ… Tab Switching Logic -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const tabs = document.querySelectorAll('.tab-link');
      const sections = document.querySelectorAll('section');

      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          tabs.forEach(t => t.classList.remove('active'));
          sections.forEach(s => s.classList.remove('active'));

          tab.classList.add('active');
          const target = document.getElementById(tab.dataset.tab);
          if (target) target.classList.add('active');
        });
      });
    });
  </script>
  <!-- âœ… CHUNK 3: SECTION â€“ HOME MANAGER -->
<section id="home" class="active">
  <h3>ğŸ  Home Manager</h3>
  <div style="display: flex; flex-direction: column; gap: 2rem;">

    <!-- ğŸ’¡ Finance Tips -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ’¡ Add Finance Tip</h4>
      <textarea id="tipInput" rows="2" placeholder="Write tip (optional)..." style="width: 100%;"></textarea>
      <button onclick="addFinanceTip()">â• Add Tip</button>
    </div>

    <!-- ğŸ‚ Birthdays -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ‚ Add Birthday</h4>
      <input type="text" id="bdayName" placeholder="Student's name (optional)" style="width: 49%;" />
      <input type="date" id="bdayDate" style="width: 49%;" />
      <br><br>
      <input type="file" id="bdayImage" accept="image/*" />
      <br><br>
      <img id="bdayPreview" style="max-height: 120px; display: none;" />
      <br>
      <button onclick="addBirthday()">â• Save Birthday</button>
    </div>

    <!-- ğŸ“¸ Ad Upload -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ“¸ Upload Advert Image</h4>
      <input type="file" id="adImage" accept="image/*" />
      <br><br>
      <img id="adPreview" style="max-height: 120px; display: none;" />
      <br><br>
      <input type="text" id="adLink" placeholder="Ad link (optional)" style="width: 60%;" />
      <br><br>
      <button onclick="uploadAd()">ğŸ“¤ Upload Ad</button>
    </div>

  </div>

  <script>
    // Finance Tips
    async function addFinanceTip() {
      const tip = document.getElementById('tipInput').value.trim();
      if (!tip) return; // Skip empty
      await db.collection('financeTips').add({ text: tip, createdAt: new Date() });
      alert('Tip added!');
      document.getElementById('tipInput').value = '';
    }

    // Birthday Preview
    const bdayInput = document.getElementById('bdayImage');
    const bdayPreview = document.getElementById('bdayPreview');

    bdayInput.addEventListener('change', e => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = e => {
          bdayPreview.src = e.target.result;
          bdayPreview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      }
    });

    async function addBirthday() {
      const name = document.getElementById('bdayName').value.trim();
      const date = document.getElementById('bdayDate').value;
      const file = bdayInput.files[0];

      let imageUrl = '';
      if (file) {
        const filename = `birthdays/${Date.now()}-${file.name}`;
        const ref = storage.ref().child(filename);
        await ref.put(file);
        imageUrl = await ref.getDownloadURL();
      }

      await db.collection('birthdays').add({ name, date, imageUrl, createdAt: new Date() });
      alert('Birthday saved!');
      document.getElementById('bdayName').value = '';
      document.getElementById('bdayDate').value = '';
      bdayInput.value = '';
      bdayPreview.style.display = 'none';
    }

    // Ad Preview
    const adInput = document.getElementById('adImage');
    const adPreview = document.getElementById('adPreview');

    adInput.addEventListener('change', e => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = e => {
          adPreview.src = e.target.result;
          adPreview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      }
    });

    async function uploadAd() {
      const file = adInput.files[0];
      const link = document.getElementById('adLink').value.trim();
      if (!file) return alert('Please select an image to upload.');

      const filename = `ads/${Date.now()}-${file.name}`;
      const ref = storage.ref().child(filename);
      await ref.put(file);
      const url = await ref.getDownloadURL();
      await db.collection('ads').add({ imageUrl: url, link, createdAt: new Date() });

      alert('Ad uploaded!');
      adInput.value = '';
      document.getElementById('adLink').value = '';
      adPreview.style.display = 'none';
    }
  </script>
</section>
<!-- âœ… CHUNK 4: SECTION â€“ ANNOUNCEMENTS -->
<section id="announcements">
  <h3>ğŸ“¢ Announcements</h3>
  <div style="display: flex; flex-direction: column; gap: 2rem;">

    <!-- âœï¸ Add New -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ“ Post Announcement</h4>
      <textarea id="announceInput" rows="3" placeholder="Write announcement (optional)..." style="width: 100%;"></textarea>
      <br>
      <button onclick="postAnnouncement()">ğŸ“¢ Post</button>
    </div>

    <!-- ğŸ“‹ List -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ“ƒ Posted Announcements</h4>
      <ul id="announcementList" style="list-style: none; padding-left: 0;"></ul>
    </div>

  </div>

  <script>
    const announceRef = db.collection('announcements');

    async function postAnnouncement() {
      const text = document.getElementById('announceInput').value.trim();
      if (!text) return; // Skip empty
      await announceRef.add({ text, timestamp: new Date() });
      alert('Posted!');
      document.getElementById('announceInput').value = '';
      loadAnnouncements();
    }

    async function loadAnnouncements() {
      const list = document.getElementById('announcementList');
      list.innerHTML = '';
      const snapshot = await announceRef.orderBy('timestamp', 'desc').get();
      snapshot.forEach(doc => {
        const data = doc.data();
        const li = document.createElement('li');
        li.innerHTML = `
          <div style="border: 1px solid #ddd; padding: 10px; border-radius: 8px; margin-bottom: 8px;">
            <p>${data.text || 'â€”'}</p>
            <button onclick="deleteAnnouncement('${doc.id}')">ğŸ—‘ï¸ Delete</button>
          </div>
        `;
        list.appendChild(li);
      });
    }

    async function deleteAnnouncement(id) {
      const confirmDelete = confirm('Delete this announcement?');
      if (confirmDelete) {
        await announceRef.doc(id).delete();
        loadAnnouncements();
      }
    }

    document.querySelector('[data-tab="announcements"]').addEventListener('click', loadAnnouncements);
  </script>
</section>
<!-- âœ… CHUNK 5: SECTION â€“ EVENTS -->
<section id="events">
  <h3>ğŸ“… Events Manager</h3>
  <div style="display: flex; flex-direction: column; gap: 2rem;">

    <!-- â• New Event -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ“Œ Add New Event</h4>
      <input type="text" id="eventTitle" placeholder="Event title (optional)" style="width: 100%;" />
      <br><br>
      <input type="date" id="eventDate" style="width: 100%;" />
      <br><br>
      <textarea id="eventDescription" rows="3" placeholder="Event details (optional)..." style="width: 100%;"></textarea>
      <br>
      <button onclick="addEvent()">â• Add Event</button>
    </div>

    <!-- ğŸ“ƒ Events List -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ“† Upcoming Events</h4>
      <ul id="eventList" style="list-style: none; padding-left: 0;"></ul>
    </div>

  </div>

  <script>
    const eventRef = db.collection('events');

    async function addEvent() {
      const title = document.getElementById('eventTitle').value.trim();
      const date = document.getElementById('eventDate').value;
      const desc = document.getElementById('eventDescription').value.trim();

      if (!title && !date && !desc) return; // Skip if all empty

      await eventRef.add({ title, date, description: desc, createdAt: new Date() });
      alert('Event saved!');
      document.getElementById('eventTitle').value = '';
      document.getElementById('eventDate').value = '';
      document.getElementById('eventDescription').value = '';
      loadEvents();
    }

    async function loadEvents() {
      const list = document.getElementById('eventList');
      list.innerHTML = '';
      const snapshot = await eventRef.orderBy('date', 'asc').get();
      snapshot.forEach(doc => {
        const data = doc.data();
        const li = document.createElement('li');
        li.innerHTML = `
          <div style="border: 1px solid #ddd; padding: 10px; border-radius: 8px; margin-bottom: 8px;">
            <strong>${data.title || 'Untitled'}</strong><br>
            <em>${data.date || 'No Date'}</em><br>
            <p>${data.description || 'No Description'}</p>
            <button onclick="deleteEvent('${doc.id}')">ğŸ—‘ï¸ Delete</button>
          </div>
        `;
        list.appendChild(li);
      });
    }

    async function deleteEvent(id) {
      const confirmDelete = confirm('Delete this event?');
      if (confirmDelete) {
        await eventRef.doc(id).delete();
        loadEvents();
      }
    }

    document.querySelector('[data-tab="events"]').addEventListener('click', loadEvents);
  </script>
</section>
<!-- âœ… CHUNK 6: SECTION â€“ CBT MANAGER -->
<section id="cbt">
  <h3>ğŸ§  CBT Question Manager</h3>
  <div style="display: flex; flex-direction: column; gap: 2rem;">

    <!-- â• Add Question -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>â• Add Question</h4>
      <input type="text" id="cbtSubject" placeholder="Subject (e.g. Finance)" style="width: 100%;" />
      <br><br>
      <textarea id="cbtQuestion" rows="2" placeholder="Question text..." style="width: 100%;"></textarea>
      <br><br>
      <input type="text" id="optionA" placeholder="Option A" style="width: 49%;" />
      <input type="text" id="optionB" placeholder="Option B" style="width: 49%;" />
      <br><br>
      <input type="text" id="optionC" placeholder="Option C" style="width: 49%;" />
      <input type="text" id="optionD" placeholder="Option D" style="width: 49%;" />
      <br><br>
      <input type="text" id="correctAnswer" placeholder="Correct Option (A/B/C/D)" style="width: 100%;" />
      <br><br>
      <button onclick="addCBTQuestion()">â• Save Question</button>
    </div>

    <!-- ğŸ“ƒ Questions List -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ“‹ All Questions</h4>
      <div>
        <input type="text" id="cbtFilter" placeholder="Filter by subject..." oninput="loadCBTQuestions()" style="width: 50%;" />
      </div>
      <br>
      <ul id="cbtQuestionList" style="list-style: none; padding-left: 0;"></ul>
    </div>
  </div>

  <script>
    const cbtRef = db.collection('cbtQuestions');

    async function addCBTQuestion() {
      const subject = document.getElementById('cbtSubject').value.trim();
      const question = document.getElementById('cbtQuestion').value.trim();
      const A = document.getElementById('optionA').value.trim();
      const B = document.getElementById('optionB').value.trim();
      const C = document.getElementById('optionC').value.trim();
      const D = document.getElementById('optionD').value.trim();
      const correct = document.getElementById('correctAnswer').value.trim().toUpperCase();

      if (!subject && !question) return; // Must provide something

      await cbtRef.add({
        subject,
        question,
        options: { A, B, C, D },
        correct,
        createdAt: new Date()
      });

      alert('Question added!');
      ['cbtSubject', 'cbtQuestion', 'optionA', 'optionB', 'optionC', 'optionD', 'correctAnswer'].forEach(id => document.getElementById(id).value = '');
      loadCBTQuestions();
    }

    async function loadCBTQuestions() {
      const filter = document.getElementById('cbtFilter').value.trim().toLowerCase();
      const list = document.getElementById('cbtQuestionList');
      list.innerHTML = '';
      let query = cbtRef;
      if (filter) query = query.where('subject', '>=', filter).where('subject', '<=', filter + '\uf8ff');

      const snapshot = await query.orderBy('createdAt', 'desc').get();
      snapshot.forEach(doc => {
        const data = doc.data();
        const li = document.createElement('li');
        li.innerHTML = `
          <div style="border: 1px solid #ddd; padding: 10px; border-radius: 8px; margin-bottom: 8px;">
            <strong>${data.subject || 'No Subject'}</strong><br>
            <p>${data.question || '[No Question]'}</p>
            <ul>
              <li>A: ${data.options?.A || '-'}</li>
              <li>B: ${data.options?.B || '-'}</li>
              <li>C: ${data.options?.C || '-'}</li>
              <li>D: ${data.options?.D || '-'}</li>
            </ul>
            <p><strong>Correct:</strong> ${data.correct || 'N/A'}</p>
            <button onclick="deleteCBTQuestion('${doc.id}')">ğŸ—‘ï¸ Delete</button>
          </div>
        `;
        list.appendChild(li);
      });
    }

    async function deleteCBTQuestion(id) {
      const confirmDelete = confirm('Delete this question?');
      if (confirmDelete) {
        await cbtRef.doc(id).delete();
        loadCBTQuestions();
      }
    }

    document.querySelector('[data-tab="cbt"]').addEventListener('click', loadCBTQuestions);
  </script>
</section>
<!-- âœ… CHUNK 7: SECTION â€“ LOST & FOUND -->
<section id="lostfound">
  <h3>ğŸ’ Lost & Found Manager</h3>
  <div style="display: flex; flex-direction: column; gap: 2rem;">

    <!-- ğŸ“‹ Submitted Items -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ“„ All Reports</h4>
      <ul id="lostFoundList" style="list-style: none; padding-left: 0;"></ul>
    </div>
  </div>

  <script>
    const lostRef = db.collection('lostItems');

    async function loadLostFoundItems() {
      const list = document.getElementById('lostFoundList');
      list.innerHTML = '';
      const snapshot = await lostRef.orderBy('timestamp', 'desc').get();
      snapshot.forEach(doc => {
        const data = doc.data();
        const li = document.createElement('li');
        li.innerHTML = `
          <div style="border: 1px solid #ddd; border-radius: 8px; padding: 10px; margin-bottom: 10px;">
            <p><strong>Name:</strong> ${data.name || 'Anonymous'}</p>
            <p><strong>Item:</strong> ${data.item || '-'}</p>
            <p><strong>Description:</strong> ${data.description || '-'}</p>
            ${data.imageUrl ? `<img src="${data.imageUrl}" alt="item" style="max-width: 100%; max-height: 150px;" />` : ''}
            <br>
            <button onclick="deleteLostItem('${doc.id}')">ğŸ—‘ï¸ Delete</button>
          </div>
        `;
        list.appendChild(li);
      });
    }

    async function deleteLostItem(id) {
      const confirmDelete = confirm('Delete this lost/found report?');
      if (confirmDelete) {
        await lostRef.doc(id).delete();
        loadLostFoundItems();
      }
    }

    document.querySelector('[data-tab="lostfound"]').addEventListener('click', loadLostFoundItems);
  </script>
</section>
<!-- âœ… CHUNK 8: SECTION â€“ LEADERBOARD -->
<section id="leaderboard">
  <h3>ğŸ† Leaderboard Manager</h3>
  <div style="display: flex; flex-direction: column; gap: 2rem;">

    <!-- ğŸ” Search or Filter -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ” View Leaderboard</h4>
      <input type="text" id="searchUser" placeholder="Search by name..." oninput="loadLeaderboard()" style="width: 60%;" />
      <ul id="leaderboardList" style="list-style: none; padding-left: 0;"></ul>
    </div>
  </div>

  <script>
    const leaderboardRef = db.collection('leaderboard');

    async function loadLeaderboard() {
      const filter = document.getElementById('searchUser').value.trim().toLowerCase();
      const list = document.getElementById('leaderboardList');
      list.innerHTML = '';
      const snapshot = await leaderboardRef.orderBy('score', 'desc').get();
      snapshot.forEach(doc => {
        const data = doc.data();
        if (filter && !(data.name || '').toLowerCase().includes(filter)) return;

        const li = document.createElement('li');
        li.innerHTML = `
          <div style="border: 1px solid #ddd; padding: 10px; border-radius: 8px; margin-bottom: 8px;">
            <strong>${data.name || 'Unnamed User'}</strong> â€” <span>Score: ${data.score || 0}</span><br><br>
            <input type="number" placeholder="New Score" id="score-${doc.id}" style="width: 100px;"/>
            <button onclick="updateScore('${doc.id}')">ğŸ’¾ Update</button>
            <button onclick="deleteUserScore('${doc.id}')">ğŸ—‘ï¸ Delete</button>
          </div>
        `;
        list.appendChild(li);
      });
    }

    async function updateScore(id) {
      const newScore = parseInt(document.getElementById(`score-${id}`).value);
      if (isNaN(newScore)) return alert('Enter a valid number');
      await leaderboardRef.doc(id).update({ score: newScore });
      alert('Score updated!');
      loadLeaderboard();
    }

    async function deleteUserScore(id) {
      const confirmDelete = confirm('Delete this user from leaderboard?');
      if (confirmDelete) {
        await leaderboardRef.doc(id).delete();
        loadLeaderboard();
      }
    }

    document.querySelector('[data-tab="leaderboard"]').addEventListener('click', loadLeaderboard);
  </script>
</section>
<!-- âœ… CHUNK 9: SECTION â€“ FEEDBACK -->
<section id="feedback">
  <h3>ğŸ“¨ User Feedback</h3>
  <div style="display: flex; flex-direction: column; gap: 2rem;">

    <!-- ğŸ“‹ Feedback List -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ“¬ Received Feedback</h4>
      <ul id="feedbackList" style="list-style: none; padding-left: 0;"></ul>
    </div>
  </div>

  <script>
    const feedbackRef = db.collection('feedback');

    async function loadFeedback() {
      const list = document.getElementById('feedbackList');
      list.innerHTML = '';
      const snapshot = await feedbackRef.orderBy('timestamp', 'desc').get();
      snapshot.forEach(doc => {
        const data = doc.data();
        const li = document.createElement('li');
        li.innerHTML = `
          <div style="border: 1px solid #ddd; border-radius: 8px; padding: 10px; margin-bottom: 10px;">
            <p><strong>Name:</strong> ${data.name || 'Anonymous'}</p>
            <p><strong>Email:</strong> ${data.email || '-'}</p>
            <p><strong>Message:</strong><br> ${data.message || '[Empty]'}</p>
            <button onclick="deleteFeedback('${doc.id}')">ğŸ—‘ï¸ Delete</button>
          </div>
        `;
        list.appendChild(li);
      });
    }

    async function deleteFeedback(id) {
      const confirmDelete = confirm('Delete this feedback?');
      if (confirmDelete) {
        await feedbackRef.doc(id).delete();
        loadFeedback();
      }
    }

    document.querySelector('[data-tab="feedback"]').addEventListener('click', loadFeedback);
  </script>
</section>
<!-- âœ… CHUNK 10: SECTION â€“ DOWNLOADS -->
<section id="downloads">
  <h3>ğŸ“‚ Downloads Manager</h3>
  <div style="display: flex; flex-direction: column; gap: 2rem;">

    <!-- ğŸ“¤ Upload New File -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ“¤ Upload New File</h4>
      <input type="text" id="fileTitle" placeholder="File title (optional)" style="width: 100%;" />
      <br><br>
      <input type="file" id="uploadFile" />
      <br><br>
      <button onclick="uploadDownloadFile()">ğŸ“¥ Upload File</button>
    </div>

    <!-- ğŸ“ƒ File List -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ“‹ Uploaded Files</h4>
      <ul id="downloadList" style="list-style: none; padding-left: 0;"></ul>
    </div>
  </div>

  <script>
    const downloadsRef = db.collection('downloads');
    const uploadRef = storage.ref('downloads');

    async function uploadDownloadFile() {
      const file = document.getElementById('uploadFile').files[0];
      const title = document.getElementById('fileTitle').value.trim();
      if (!file) return alert('No file selected');

      const filePath = `downloads/${Date.now()}_${file.name}`;
      const fileRef = uploadRef.child(filePath);
      await fileRef.put(file);
      const downloadURL = await fileRef.getDownloadURL();

      await downloadsRef.add({ title, url: downloadURL, filename: file.name, timestamp: new Date() });

      alert('File uploaded!');
      document.getElementById('uploadFile').value = '';
      document.getElementById('fileTitle').value = '';
      loadDownloads();
    }

    async function loadDownloads() {
      const list = document.getElementById('downloadList');
      list.innerHTML = '';
      const snapshot = await downloadsRef.orderBy('timestamp', 'desc').get();
      snapshot.forEach(doc => {
        const data = doc.data();
        const li = document.createElement('li');
        li.innerHTML = `
          <div style="border: 1px solid #ddd; border-radius: 8px; padding: 10px; margin-bottom: 10px;">
            <p><strong>${data.title || data.filename || 'Unnamed File'}</strong></p>
            <a href="${data.url}" target="_blank">â¬‡ï¸ Download</a>
            <br><br>
            <button onclick="deleteDownload('${doc.id}')">ğŸ—‘ï¸ Delete</button>
          </div>
        `;
        list.appendChild(li);
      });
    }

    async function deleteDownload(id) {
      const confirmDelete = confirm('Delete this file?');
      if (confirmDelete) {
        await downloadsRef.doc(id).delete();
        loadDownloads();
      }
    }

    document.querySelector('[data-tab="downloads"]').addEventListener('click', loadDownloads);
  </script>
</section>
<!-- âœ… CHUNK 11: SECTION â€“ ADMIN SETTINGS -->
<section id="settings">
  <h3>âš™ï¸ Admin Settings</h3>
  <div style="display: flex; flex-direction: column; gap: 2rem;">

    <!-- ğŸ§¾ Site Title and Motto -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ§¾ Update Site Title & Motto</h4>
      <input type="text" id="siteTitle" placeholder="Site Title (optional)" style="width: 100%;" />
      <br><br>
      <textarea id="siteMotto" rows="2" placeholder="Site Motto / Description..." style="width: 100%;"></textarea>
      <br><br>
      <button onclick="saveSettings()">ğŸ’¾ Save Settings</button>
    </div>

    <!-- ğŸ–¼ï¸ Upload Logo -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ–¼ï¸ Upload Logo</h4>
      <input type="file" id="logoUpload" accept="image/*" />
      <br><br>
      <img id="logoPreview" style="max-height: 120px; display: none;" />
      <br><br>
      <button onclick="uploadLogo()">ğŸ“¤ Upload Logo</button>
    </div>

    <!-- ğŸ“„ Current Settings View -->
    <div style="border: 1px solid #ccc; padding: 1rem; border-radius: 10px;">
      <h4>ğŸ“„ Current Settings</h4>
      <div id="currentSettings"></div>
    </div>

  </div>

  <script>
    const settingsRef = db.collection('siteSettings').doc('main');
    const logoStorageRef = storage.ref('siteAssets/logo.png');

    // Load current settings
    async function loadSettings() {
      const doc = await settingsRef.get();
      if (doc.exists) {
        const data = doc.data();
        document.getElementById('currentSettings').innerHTML = `
          <p><strong>Site Title:</strong> ${data.title || '-'}</p>
          <p><strong>Motto:</strong> ${data.motto || '-'}</p>
          ${data.logoUrl ? `<img src="${data.logoUrl}" style="max-height: 80px;" />` : ''}
        `;
      }
    }

    async function saveSettings() {
      const title = document.getElementById('siteTitle').value.trim();
      const motto = document.getElementById('siteMotto').value.trim();
      await settingsRef.set({ title, motto }, { merge: true });
      alert('Settings saved!');
      loadSettings();
    }

    const logoInput = document.getElementById('logoUpload');
    const logoPreview = document.getElementById('logoPreview');

    logoInput.addEventListener('change', e => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = e => {
          logoPreview.src = e.target.result;
          logoPreview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      }
    });

    async function uploadLogo() {
      const file = logoInput.files[0];
      if (!file) return alert('Choose a logo file');
      await logoStorageRef.put(file);
      const url = await logoStorageRef.getDownloadURL();
      await settingsRef.set({ logoUrl: url }, { merge: true });
      alert('Logo uploaded!');
      logoPreview.style.display = 'none';
      logoInput.value = '';
      loadSettings();
    }

    document.querySelector('[data-tab="settings"]').addEventListener('click', loadSettings);
  </script>
</section>
<!-- âœ… CHUNK 12: UNIVERSAL LOADING INDICATOR -->
<style>
  .loader {
    display: none;
    text-align: center;
    padding: 1rem;
  }
  .loader.active {
    display: block;
  }
</style>

<div id="globalLoader" class="loader">â³ Loading, please wait...</div>

<script>
  // Wrapper to handle loader while fetching
  async function withLoader(callback) {
    const loader = document.getElementById('globalLoader');
    loader.classList.add('active');
    try {
      await callback();
    } finally {
      loader.classList.remove('active');
    }
  }

  // Example usage inside any fetch function:
  // Instead of:
  // await loadAnnouncements();
  // Do:
  // await withLoader(loadAnnouncements);
</script>
